#include "dummypegenerator.hpp"

#include "LIEF/PE.hpp"

#include <iostream>

using namespace LIEF::PE;

bool DummyPEGenerator::generate() {
    bool status {false};

    std::cout << "PE Rebuilder" << '\n';

    Binary *binary = new Binary(PE_TYPE::PE32_PLUS);
    Builder builder{*binary};

    builder
        .build_imports(true)
        .patch_imports(false)
        .build_tls(false)
        .build_resources(false);

    builder.build();
    builder.write("dummy.exe");

    delete binary;

    status = true;

    return status;
}
