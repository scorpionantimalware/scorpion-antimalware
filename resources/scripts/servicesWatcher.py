import win32service
import time

def print_running_services():
    while True:
        # Open the SCM database
        scm_manager = win32service.OpenSCManager(None, None, win32service.SC_MANAGER_ENUMERATE_SERVICE)

        # Get list of all running services
        running_services = win32service.EnumServicesStatus(scm_manager, win32service.SERVICE_WIN32, win32service.SERVICE_STATE_ALL)

        print("Running Services:")
        for service in running_services:
            # Print service name and display name
            service_name = service[0]
            service_display_name = service[1]
            print(f"Service Name: {service_name}, Display Name: {service_display_name}")

        print("---------------------------------------------")
        win32service.CloseServiceHandle(scm_manager)
        time.sleep(5)  # Sleep for 5 seconds before checking again

if __name__ == "__main__":
    print_running_services()
