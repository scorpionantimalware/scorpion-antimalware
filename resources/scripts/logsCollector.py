###################################################################################
#                                                                                 #
# logs_collector.py                                                               #
#                                                                                 #
###################################################################################
#                                                                                 #
#    Scorpion Anti-malware is a free Open Source AI-powered Anti-malware          #
#    framework for Researchers.                                                   #
#                                                                                 #
#    Copyright (c) 2024-present  (see AUTHORS.md).                                #
#                                                                                 #
#    This program is free software: you can redistribute it and/or modify         #
#    it under the terms of the GNU General Public License as published by         #
#    the Free Software Foundation, either version 3 of the License, or            #
#    (at your option) any later version.                                          #
#                                                                                 #
#    This program is distributed in the hope that it will be useful,              #
#    but WITHOUT ANY WARRANTY; without even the implied warranty of               #
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                #
#    GNU General Public License for more details.                                 #
#                                                                                 #
#    You should have received a copy of the GNU General Public License            #
#    along with this program.  If not, see <https://www.gnu.org/licenses/>.       #
#                                                                                 #
###################################################################################


import win32evtlog

def collect_event_logs_realtime():
    # Open the Application Event Log
    application_log_handle = win32evtlog.OpenEventLog(None, "Application")
    # Open the System Event Log
    system_log_handle = win32evtlog.OpenEventLog(None, "System")

    while True:
        # Read new events from the Application log
        application_events = win32evtlog.ReadEventLog(application_log_handle, win32evtlog.EVENTLOG_BACKWARDS_READ | win32evtlog.EVENTLOG_SEQUENTIAL_READ, 0)
        for event in application_events:
            yield event.StringInserts

        # Read new events from the System log
        system_events = win32evtlog.ReadEventLog(system_log_handle, win32evtlog.EVENTLOG_BACKWARDS_READ | win32evtlog.EVENTLOG_SEQUENTIAL_READ, 0)
        for event in system_events:
            yield event.StringInserts

if __name__ == "__main__":
    print("Monitoring Windows Event Logs in real-time...")

    # Collect and print new event logs
    for log in collect_event_logs_realtime():
        print(log)
