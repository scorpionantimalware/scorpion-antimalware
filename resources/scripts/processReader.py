###################################################################################
#                                                                                 #
# process_reader.py                                                               #
#                                                                                 #
###################################################################################
#                                                                                 #
#    Scorpion Anti-malware is a free Open Source AI-powered Anti-malware          #
#    framework for Researchers.                                                   #
#                                                                                 #
#    Copyright (c) 2024-present  (see AUTHORS.md).                                #
#                                                                                 #
#    This program is free software: you can redistribute it and/or modify         #
#    it under the terms of the GNU General Public License as published by         #
#    the Free Software Foundation, either version 3 of the License, or            #
#    (at your option) any later version.                                          #
#                                                                                 #
#    This program is distributed in the hope that it will be useful,              #
#    but WITHOUT ANY WARRANTY; without even the implied warranty of               #
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                #
#    GNU General Public License for more details.                                 #
#                                                                                 #
#    You should have received a copy of the GNU General Public License            #
#    along with this program.  If not, see <https://www.gnu.org/licenses/>.       #
#                                                                                 #
###################################################################################


import psutil
import time

def print_running_processes():
    # Get a list of all running processes
    running_processes = psutil.process_iter()

    # Print process information
    for process in running_processes:
        try:
            process_info = process.as_dict(attrs=['pid', 'name', 'username'])
            print(f"PID: {process_info['pid']}, Name: {process_info['name']}, User: {process_info['username']}")
        except (psutil.NoSuchProcess, psutil.AccessDenied, psutil.ZombieProcess):
            # Some processes might have terminated or we don't have permission to access them
            pass

if __name__ == "__main__":
    while True:
        print("Currently running processes:")
        print_running_processes()
        time.sleep(5) 
