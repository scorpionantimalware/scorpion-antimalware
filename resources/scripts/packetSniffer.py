###################################################################################
#                                                                                 #
# packet_sniffer.py                                                               #
#                                                                                 #
###################################################################################
#                                                                                 #
#    Scorpion Anti-malware is a free Open Source AI-powered Anti-malware          #
#    framework for Researchers.                                                   #
#                                                                                 #
#    Copyright (c) 2024-present  (see AUTHORS.md).                                #
#                                                                                 #
#    This program is free software: you can redistribute it and/or modify         #
#    it under the terms of the GNU General Public License as published by         #
#    the Free Software Foundation, either version 3 of the License, or            #
#    (at your option) any later version.                                          #
#                                                                                 #
#    This program is distributed in the hope that it will be useful,              #
#    but WITHOUT ANY WARRANTY; without even the implied warranty of               #
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                #
#    GNU General Public License for more details.                                 #
#                                                                                 #
#    You should have received a copy of the GNU General Public License            #
#    along with this program.  If not, see <https://www.gnu.org/licenses/>.       #
#                                                                                 #
###################################################################################


from scapy.all import sniff

# def packet_callback(packet):
#     if packet.haslayer("IP"):
#         src_ip = packet["IP"].src
#         dst_ip = packet["IP"].dst
#         print(f"Source IP: {src_ip} --> Destination IP: {dst_ip}")

# # Sniff packets on the default interface (usually eth0 on Linux)
# # You can specify interface by passing iface argument to sniff function
# sniff(prn=packet_callback, store=0, iface='Wi-Fi')


from scapy.all import sniff

def packet_callback(packet):
    print(packet.summary())  # Print a summary of the packet

# Sniff packets on the default interface (usually eth0 on Linux)
# You can specify interface by passing iface argument to sniff function
sniff(prn=packet_callback, store=0, iface='Wi-Fi')
