import subprocess

def get_scheduled_tasks():
    # Run the schtasks command to get information about all scheduled tasks
    result = subprocess.run(["schtasks", "/query", "/fo", "csv"], capture_output=True, text=True)

    # Check if the command was successful
    if result.returncode == 0:
        # Split the output by lines and skip the first two lines (header and delimiter)
        lines = result.stdout.strip().split('\n')[2:]
        # Extract task names from the output
        tasks = [line.split(',')[0].strip('"') for line in lines]
        return tasks
    else:
        print("Failed to retrieve scheduled tasks.")
        return []

if __name__ == "__main__":
    print("Scheduled Tasks:")
    scheduled_tasks = get_scheduled_tasks()
    for task in scheduled_tasks:
        print(task)
