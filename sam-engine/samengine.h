#ifndef SCORPION_ANTIMALWARE_ENGINE_H
#define SCORPION_ANTIMALWARE_ENGINE_H

#include <thread>
#include <mutex>

#ifndef STATIC_ANN_ONNX_MODELPATH
#error "STATIC_ANN_ONNX_MODELPATH is not defined"
#endif

// #ifndef STATIC_CNN_ONNX_MODELPATH
// #error "STATIC_CNN_ONNX_MODELPATH is not defined"
// #endif

// #ifndef DYNAMIC_ANN_ONNX_MODELPATH
// #error "DYNAMIC_ANN_ONNX_MODELPATH is not defined"
// #endif

// #ifndef DYNAMIC_CNN_ONNX_MODELPATH
// #error "DYNAMIC_CNN_ONNX_MODELPATH is not defined"
// #endif

class SAMEngine {
 public:
  SAMEngine();
  ~SAMEngine();

  bool scan();

  private:
    std::thread* engine_thread;
    std::mutex* mtx;

    /**
     * @brief Start the scan process
     * 
     * @note This function is the entry point for the scan process. This 
     *       function is Multi-threaded.
    */
    bool fire_scan(const std::string& pe_file_path);
}; // class SAMEngine

#endif // SCORPION_ANTIMALWARE_ENGINE_H
